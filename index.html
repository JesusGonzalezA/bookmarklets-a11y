<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="color-scheme" content="dark" />
    <title>Bookmarklets para Accesibilidad</title>
    <style>
      body { font-family: Verdana, sans-serif; margin: 1.25rem; max-width: 50rem; margin: 1.25rem auto; background: #1a1a1a; color: #ffffff; }
      h1 { padding: 1rem; }
      .search-container { padding: 1rem; border: 1px solid #333; border-radius: 0.5rem; background: #1e1e1e; margin-bottom: 1.25rem; margin-top: 1.25rem; }
      .search-container label { display: block; margin-bottom: 0.5rem; font-weight: bold; color: #ffffff; }
      input { padding: 0.5rem; width: 100%; max-width: 18.75rem; border: 1px solid #555; border-radius: 0.25rem; background: #2a2a2a; color: #ffffff; margin-bottom: 0.625rem; }
      input::placeholder { color: #cccccc; }
      ul { list-style: none; padding: 0; }
      li { margin-bottom: 1.25rem; padding: 0.625rem; border: 1px solid #333; border-radius: 0.3125rem; background: #1e1e1e; }
      button { padding: 0.5rem 0.75rem; background: #0066cc; color: white; border: 2px solid #004499; border-radius: 0.1875rem; cursor: pointer; margin-right: 0.5rem; }
      button:hover { background: #004499; }
      a { padding: 0.5rem 0.75rem; background: #28a745; color: white; text-decoration: none; border-radius: 0.1875rem; }
      a:hover { background: #218838; }
      .hidden { display: none; }
      details { border: 1px solid #333; border-radius: 0.3125rem; padding: 0.625rem; background: #1e1e1e; margin-bottom: 1.25rem; }
      summary { cursor: pointer; font-weight: bold; }
    </style>
    <style>
      @media (max-width: 600px) {
        body { padding: 1rem; }
        .search-container { padding: 0.75rem; }
        li { padding: 0.5rem; }
        details { padding: 0.5rem; }
      }
    </style>
  </head>
  <body>
    <header>
      <h1>Bookmarklets para Accesibilidad</h1>
    </header>

    <main>

    <section>
      <details>
        <summary>Instrucciones para Añadir Bookmarklets</summary>
        <p>Los bookmarklets son pequeños scripts de JavaScript que puedes guardar como marcadores en tu navegador para ejecutar funciones de accesibilidad en cualquier página web.</p>
        <ol>
          <li>Haz clic en el botón "Copiar" junto al bookmarklet que deseas.</li>
          <li>Abre la barra de marcadores de tu navegador (generalmente Ctrl+Shift+B o Cmd+Shift+B).</li>
          <li>Arrastra un enlace vacío desde la barra de marcadores a la barra de direcciones, o crea un nuevo marcador.</li>
          <li>Pega el código copiado en el campo de URL del marcador.</li>
          <li>Asigna un nombre al marcador y guárdalo.</li>
          <li>Para usar, haz clic en el marcador mientras estás en una página web.</li>
        </ol>
      </details>
    </section>

    <section class="search-container" style="margin-top: 1.25rem;">
      <label for="filter-input">Filtrar bookmarklets</label>
        <input id="filter-input" type="search" placeholder="Buscar por nombre o descripción..." aria-describedby="filter-help" autocomplete="off">
        <span id="filter-help" class="sr-only" style="display: block;">Escribe para filtrar la lista de bookmarklets por nombre o descripción.</span>
    </section>

    <section>
      <h2>Lista de Bookmarklets</h2>
      <div id="result-count" aria-live="polite" aria-atomic="true"></div>
      <ul id="bookmarklet-list">
        <!-- Los elementos se generarán dinámicamente con JavaScript -->
      </ul>
    </section>

    <script>
      const bookmarklets = [
        { name: 'focus-order', desc: 'Verifica el orden de foco en la página para asegurar navegación accesible.' },
        { name: 'heading-hierarchy', desc: 'Analiza la jerarquía de encabezados (H1-H6) para accesibilidad.' },
        { name: 'images-no-alt', desc: 'Identifica imágenes sin texto alternativo (alt) que afectan la accesibilidad.' }
      ];

      const list = document.getElementById('bookmarklet-list');
      const filterInput = document.getElementById('filter-input');

      function updateResultCount() {
        const count = list.children.length;
        const resultCountDiv = document.getElementById('result-count');
        resultCountDiv.textContent = `Mostrando ${count} resultado${count !== 1 ? 's' : ''}`;
      }

      function renderList(filter = '') {
        list.innerHTML = '';
        bookmarklets.forEach(bookmarklet => {
          if (filter && !bookmarklet.name.toLowerCase().includes(filter.toLowerCase()) && !bookmarklet.desc.toLowerCase().includes(filter.toLowerCase())) {
            return;
          }
          const li = document.createElement('li');
          li.setAttribute('data-name', bookmarklet.name);
          li.innerHTML = `
            <h3>${bookmarklet.name.replace('-', ' ').toUpperCase()}</h3>
            <p>${bookmarklet.desc}</p>
            <button type="button" aria-label="Copiar código del bookmarklet ${bookmarklet.name}">Copiar código</button>
            <a href="#" id="install-${bookmarklet.name}" aria-label="Usar bookmarklet ${bookmarklet.name}">Usar</a>
          `;
          const button = li.querySelector('button');
          button.addEventListener('click', () => {
            fetch(`dist/${bookmarklet.name}.js`)
              .then(response => response.text())
              .then(code => {
                navigator.clipboard.writeText(code).then(() => {
                  alert('Código copiado al portapapeles.');
                }).catch(err => {
                  console.error('Error al copiar: ', err);
                  alert('Error al copiar. Revisa la consola.');
                });
              })
              .catch(err => {
                console.error('Error al cargar el código: ', err);
                alert('Error al cargar el código del bookmarklet.');
              });
          });

          // Set href for install link
          fetch(`dist/${bookmarklet.name}.js`)
            .then(response => response.text())
            .then(code => {
              document.getElementById(`install-${bookmarklet.name}`).href = code;
            })
            .catch(err => {
              console.error('Error al cargar el código para instalar: ', err);
            });

          list.appendChild(li);
        });
        updateResultCount();
      }

      function debounce(func, delay) {
        let timeoutId;
        return function(...args) {
          clearTimeout(timeoutId);
          timeoutId = setTimeout(() => func.apply(this, args), delay);
        };
      }

      const debouncedRender = debounce((value) => renderList(value), 300);

      renderList();

      filterInput.addEventListener('input', (e) => {
        debouncedRender(e.target.value);
      });
    </script>
  </main>
</body>
</html>
